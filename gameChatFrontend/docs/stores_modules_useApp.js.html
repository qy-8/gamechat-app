<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: stores/modules/useApp.js</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: stores/modules/useApp.js</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file stores/modules/appStore.js
 * @description Pinia Store，用于管理应用程序的全局加载状态。
 * 该 Store 通过跟踪正在进行的异步请求数量来控制一个全局加载指示器。
 * @module AppStore
 */

import { defineStore } from 'pinia'
import { ref } from 'vue'

/**
 * @function useAppStore
 * @description Pinia Store，用于管理应用程序的全局加载状态。
 * 它通过维护一个请求计数器来判断是否显示全局加载动画。
 * @returns {{
 * isLoading: Ref&lt;boolean>,
 * startLoading: Function,
 * stopLoading: Function
 * }}
 * @property {Ref&lt;boolean>} isLoading - 响应式布尔值，表示应用程序当前是否处于加载状态。
 * @property {Function} startLoading - 递增加载计数，并根据计数显示加载动画。
 * @property {Function} stopLoading - 递减加载计数，并根据计数隐藏加载动画。
 */
export const useAppStore = defineStore('app', () => {
  // --- 状态 (State) ---
  /**
   * @type {Ref&lt;number>}
   * @description 记录当前正在进行的异步请求数量。
   */
  const globalLoadingCount = ref(0)
  /**
   * @type {Ref&lt;boolean>}
   * @description 表示应用程序是否处于加载状态（当 `globalLoadingCount > 0` 时为 `true`）。
   */
  const isLoading = ref(false)

  // --- 操作 (Actions) ---

  /**
   * @function startLoading
   * @description 递增加载计数器。
   * 如果计数器从 0 变为 1，则将 `isLoading` 设置为 `true`，显示全局加载动画。
   * @returns {void}
   */
  function startLoading() {
    globalLoadingCount.value++
    if (globalLoadingCount.value > 0) {
      isLoading.value = true
    }
  }

  /**
   * @function stopLoading
   * @description 递减加载计数器。
   * 如果计数器变为 0 或更小，则将 `isLoading` 设置为 `false`，隐藏全局加载动画。
   * 同时确保计数器不会变为负数。通常在异步请求完成后调用。
   * @returns {void}
   */
  function stopLoading() {
    globalLoadingCount.value--
    if (globalLoadingCount.value &lt;= 0) {
      globalLoadingCount.value = 0 // 防止计数器出现负数
      isLoading.value = false
    }
  }

  // --- 返回 Store 的状态和操作 ---
  return {
    isLoading,
    startLoading,
    stopLoading
  }
})
</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-AppStore.html">AppStore</a></li><li><a href="module-AuthAPI.html">AuthAPI</a></li><li><a href="module-AuthService.html">AuthService</a></li><li><a href="module-ChannelStore.html">ChannelStore</a></li><li><a href="module-ChatAPI.html">ChatAPI</a></li><li><a href="module-ChatStore.html">ChatStore</a></li><li><a href="module-EventBus.html">EventBus</a></li><li><a href="module-FriendAPI.html">FriendAPI</a></li><li><a href="module-FriendStore.html">FriendStore</a></li><li><a href="module-GroupAPI.html">GroupAPI</a></li><li><a href="module-GroupStore.html">GroupStore</a></li><li><a href="module-MainApplication.html">MainApplication</a></li><li><a href="module-PasswordValidators.html">PasswordValidators</a></li><li><a href="module-PiniaStore.html">PiniaStore</a></li><li><a href="module-Request.html">Request</a></li><li><a href="module-SocketService.html">SocketService</a></li><li><a href="module-ThemeStore.html">ThemeStore</a></li><li><a href="module-UserAPI.html">UserAPI</a></li><li><a href="module-UserStore.html">UserStore</a></li><li><a href="module-router.html">router</a></li></ul><h3>Events</h3><ul><li><a href="module-SocketService.html#~event:connect">connect</a></li><li><a href="module-SocketService.html#~event:connect_error">connect_error</a></li><li><a href="module-SocketService.html#~event:disconnect">disconnect</a></li><li><a href="module-SocketService.html#~event:new_friend_request">new_friend_request</a></li><li><a href="module-SocketService.html#~event:new_group_invitation">new_group_invitation</a></li><li><a href="module-SocketService.html#~event:new_message">new_message</a></li></ul><h3>Global</h3><ul><li><a href="global.html#start">start</a></li><li><a href="global.html#startDragging">startDragging</a></li><li><a href="global.html#useCountdown">useCountdown</a></li><li><a href="global.html#useDraggableWidth">useDraggableWidth</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 4.0.4</a> on Fri Jul 04 2025 12:45:49 GMT+0800 (China Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
